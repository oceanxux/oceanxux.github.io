---
title: å“ªå’æ¢é’ˆ
tags:
  - Linux
  - nezha
categories: Linux
cover: 'https://image.6669998.xyz/nDEo38.png'
description: å®å¡”é¢æ¿æ­å»ºå“ªå’ç›‘æ§ï¼Œå¹¶æ¨é€åˆ°tgbot
abbrlink: 9aac3cfc
date: 2023-05-05 22:10:53
---
# å“ªå’ç›‘æ§
é¡¹ç›®åœ°å€ï¼š[é¡¹ç›®åœ°å€](https://github.com/naiba/nezha)ã€
![](https://www.idcfq.com/usr/uploads/2022/05/1393797066.png)

## è§£æåŸŸå
å‡†å¤‡ä¸¤ä¸ªåŸŸåï¼Œä¸€ä¸ªç”¨äºå“ªå’ç›‘æ§é¢æ¿ï¼ˆå¯ä»¥å¥—CDNï¼Œæ¯”å¦‚cfçš„ï¼‰ï¼Œä¸€ä¸ªç”¨äºé¢æ¿å’Œè¢«ç›‘æ§æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼ˆä¸å¯ä»¥å¥—ç”¨CDNï¼‰
### ä¸¾ä¾‹å¦‚ä¸‹ï¼š
ç›‘æ§é¢æ¿ç”¨åˆ°çš„ï¼šnz.oceanxx.comï¼Œè§£æåˆ°é¢æ¿æœåŠ¡å™¨ ï¼›é€šä¿¡ç”¨åˆ°çš„ï¼šnzz.oceanxx.com ï¼Œè§£æåˆ°è¢«ç›‘æ§çš„å°é¸¡ï¼Œå½“ç„¶ä¸æ‰“ç®—ç”¨åŸŸåè¿›è¡Œè®¿é—®ï¼Œç›´æ¥ç”¨IPä¹Ÿè¡Œï¼ŒæŒ‰ç…§é¡¹ç›®æ•™ç¨‹å¾ˆå¿«ä¹Ÿèƒ½å®Œæˆã€‚

## åˆ›å»ºOauth2 åº”ç”¨ï¼Œä»¥ä¾›æˆæƒ
æ³¨å†Œgithubè´¦å·æˆ–è€…giteeè´¦å·ï¼Œå¹¶è®°ä¸‹ç”¨æˆ·åï¼ˆusernameï¼‰å¤‡ç”¨ï¼Œæœ¬æ•™ç¨‹é€‰æ‹©[github](https://github.com/)

åœ¨ https://github.com/settings/developers åˆ›å»ºåº”ç”¨
```markdown
https://nz.oceanxx.com
https://nzz.oceanxx.com/oauth2/callback
```
è®°å½•ä¸‹Client IDå’ŒClient secretsï¼Œå¤‡ç”¨

# å®‰è£…å“ªå’ç›‘æ§é¢æ¿

#### å›½å¤–vps
```shell
curl -L https://raw.githubusercontent.com/naiba/nezha/master/script/install.sh  -o nezha.sh && chmod +x nezha.sh
sudo ./nezha.sh
```
##### å›½å†…vps
```shell
curl -L https://cdn.jsdelivr.net/gh/naiba/nezha@master/script/install.sh -o nezha.sh && chmod +x nezha.sh
CN=true sudo ./nezha.sh
```
é€‰æ‹©1ï¼Œå®‰è£…é¢æ¿ç«¯ï¼Œå‚æ•°é…ç½®ä¸€ä¸‹ï¼šGitHubç”¨æˆ·åï¼ŒClient IDå’ŒClient secretsï¼Œç«¯å£å¯ä»¥é»˜è®¤ï¼Œä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®ï¼Œæ ‡é¢˜éšæ„æ”¯æŒä¸­æ–‡ã€‚

# åä»£å“ªå’ç›‘æ§

#### å®‰è£…nginx debian ç³»ç»Ÿ
```shell
apt-get install nginx
```
```shell
## è¿›å…¥ç›®å½•
cd /etc/nginx
## ç¼–è¾‘æ–‡ä»¶ 
nano nginx.conf
```
æ·»åŠ ä¸€ä¸‹ä»£ç  è‡ªå®šä¹‰ä¿®æ”¹åŸŸåï¼Œå‚è€ƒ[é…ç½®åå‘ä»£ç†](https://nezha.wiki/guide/dashboard.html#é…ç½®åå‘ä»£ç†)
```yaml
user www-data;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;
events {
        worker_connections 768;
        # multi_accept on;
}
http {
        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 65;
        types_hash_max_size 2048;
        include /etc/nginx/mime.types;
        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;
        gzip on;
    server {
        listen       80 ;
        listen [::]:80;
        server_name  prometheus.hk.hyhy01.com;
        location / {
            proxy_pass http://127.0.0.1:3000;
       }
    }
    server {
        listen       80 ;
        listen [::]:80;
        server_name  nezha.hyhy01.com; ## åŸŸå
        location / {
          proxy_pass http://127.0.0.1:8008; ##ç«¯å£
          proxy_set_header Host $host;
          proxy_set_header      Upgrade $http_upgrade;
        }
        location ~ ^/(ws|terminal/.+)$  {
          proxy_pass http://127.0.0.1:8008; ## ç«¯å£
          proxy_http_version 1.1;
          proxy_set_header Upgrade $http_upgrade;
          proxy_set_header Connection "Upgrade";
          proxy_set_header Host $host;
        }
    }
}
```
# æ·»åŠ è¢«æ§ç«¯
#### ä¸‹é¢å°±æ˜¯åœ¨è¦è¢«ç›‘æ§çš„æœåŠ¡å™¨ä¸Šå®‰è£…è¢«æ§ç«¯äº†
è®¿é—® nz.idcfq.comï¼Œæˆæƒgithubç™»å½•å“ªå’ç›‘æ§é¢æ¿ï¼Œç®¡ç†åå°ï¼Œæ·»åŠ ä¸»æœºï¼Œæ·»åŠ å¥½ä¹‹åè®°å½•ä¸€ä¸‹å¯†é’¥å¤‡ç”¨ã€‚

#### å›½å¤–vps
```shell
curl -L https://raw.githubusercontent.com/naiba/nezha/master/script/install.sh  -o nezha.sh && chmod +x nezha.sh
sudo ./nezha.sh
```
#### å›½å†…vps
```shell
curl -L https://cdn.jsdelivr.net/gh/naiba/nezha@master/script/install.sh -o nezha.sh && chmod +x nezha.sh
CN=true sudo ./nezha.sh
```
é€‰æ‹©8ï¼Œå®‰è£…è¢«æ§ç«¯ï¼ŒæŒ‰è¦æ±‚è¾“å…¥é…ç½®å‘½ä»¤ï¼Œè¯·è¾“å…¥ä¸€ä¸ªè§£æåˆ°é¢æ¿æ‰€åœ¨IPçš„åŸŸåï¼ˆä¸å¯å¥—CDNï¼‰ è¾“å…¥çš„å°±æ˜¯é€šä¿¡åŸŸå nzz.idcfq.com ï¼Œé…ç½®é¢æ¿ç«¯å£å’Œå¯†é’¥ã€‚
é…ç½®å®Œæˆåï¼Œå†å»å“ªå’é¢æ¿å°±èƒ½çœ‹åˆ°åˆšåˆšæ·»åŠ çš„å°é¸¡å·²ç»ä¸Šçº¿äº†

# é…ç½®tgbot

## å“ªå’é¢æ¿ï¼Œé¡¶éƒ¨å¯¼èˆªæ ï¼Œç‚¹æŠ¥è­¦ï¼Œæ·»åŠ é€šçŸ¥æ–¹å¼

```shell
https://api.telegram.org/botä½ çš„TG_BOT_Token/sendMessage
```

- æ³¨æ„è¯·æ±‚æ–¹å¼ä¸€å®šè¦ä¸ºPOST,è€Œä¸”URLä¸­ä¸åŒ…å«ChatID

![1731329782948.png](https://image.6669998.xyz/OHgfZz.png)

å‚æ•°è·å–è¯´æ˜ï¼šbotXXXXXX ä¸­çš„ XXXXXX æ˜¯åœ¨ telegram ä¸­å…³æ³¨å®˜æ–¹ @Botfather ï¼Œè¾“å…¥/newbot ï¼Œåˆ›å»ºæ–°çš„æœºå™¨äººï¼ˆbotï¼‰æ—¶ï¼Œä¼šæä¾›çš„ tokenï¼ˆåœ¨æç¤º Use this token to access the HTTP API:åé¢ä¸€è¡Œï¼‰è¿™é‡Œ 'bot' ä¸‰ä¸ªå­—æ¯ä¸å¯å°‘ã€‚åˆ›å»º bot åï¼Œéœ€è¦å…ˆåœ¨ telegram ä¸­ä¸ BOT è¿›è¡Œå¯¹è¯ï¼ˆéšä¾¿å‘ä¸ªæ¶ˆæ¯ï¼‰ï¼Œç„¶åæ‰å¯ç”¨ API å‘é€æ¶ˆæ¯ã€‚YYYYYY æ˜¯ telegram ç”¨æˆ·çš„æ•°å­— IDã€‚ä¸æœºå™¨äºº@userinfobot å¯¹è¯å¯è·å¾—ã€‚

- å°†ä¸‹åˆ—çš„JSONå¡«å†™åˆ°Bodyä¸­

```markdown
{
    "chat_id": "ä½ çš„ChatID",
    "text": "# *Dooongæ¢é’ˆè­¦æŠ¥*\n\næ—¶é—´ï¼š#DATETIME#\næ¥è‡ª: \"#SERVER.NAME#\"\n\n*#NEZHA#*",
    "parse_mode": "Markdown",
    "reply_markup": {
        "inline_keyboard": [
            [
                {
                    "text": "æ¥è‡ª:  \"#SERVER.NAME#\"",
                    "callback_data": "#"
                }
            ],
            [
                {
                    "text": "æ¢é’ˆä»ªè¡¨ç›˜",
                    "url": "https://xxx.com"
                }
            ]
        ]
    }
}

```

- æ”¯æŒçš„å ä½ç¬¦,å¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹ä¸Šæ–¹çš„BODY

```markdown
{
    "content": "#NEZHA#",
    "ServerName": "#SERVER.NAME#",
    "ServerIP": "#SERVER.IP#",
    "ServerIPV4": "#SERVER.IPV4#",
    "ServerIPV6": "#SERVER.IPV6#",
    "CPU": "#SERVER.CPU#",
    "MEM": "#SERVER.MEM#",
    "SWAP": "#SERVER.SWAP#",
    "DISK": "#SERVER.DISK#",
    "NetInSpeed": "#SERVER.NETINSPEED#",
    "NetOutSpeed": "#SERVER.NETOUTSPEED#",
    "TransferIn": "#SERVER.TRANSFERIN#",
    "TranferOut": "#SERVER.TRANSFEROUT#",
    "Load1": "#SERVER.LOAD1#",
    "Load5": "#SERVER.LOAD5#",
    "Load15": "#SERVER.LOAD15#",
    "TCP_CONN_COUNT": "#SERVER.TCPCONNCOUNT",  # æ— æ•ˆ
    "UDP_CONN_COUNT": "#SERVER.UDPCONNCOUNT",  # æ— æ•ˆ
}
```

![1731329996897.png](https://image.6669998.xyz/K0MRTl.png)

# è‡ªå®šä¹‰ä¸»é¢˜

- è¿™ä¸€æ¬¾å“ªå’ç›‘æ§é€æ˜ä¸»é¢˜ï¼Œæ¯”è¾ƒå¥½çœ‹ï¼Œæœé›†è‡ªç½‘ç»œ
- ä½¿ç”¨æ–¹æ³•ï¼šç”¨å“ªå’çš„é»˜è®¤ä¸»é¢˜ï¼Œå¤åˆ¶ä¸‹æ–¹ä¸»é¢˜ä»£ç ï¼Œç²˜è´´åˆ°è‡ªå®šä¹‰ä»£ç é‡Œé¢ä¿å­˜å³å¯

```script
<style>
/* å±å¹•é€‚é… */
@media only screen and (min-width: 1200px) {
    .ui.container {
        width: 80% !important;
    }
}

@media only screen and (max-width: 767px) {
    .ui.card>.content>.header:not(.ui), .ui.cards>.card>.content>.header:not(.ui) {
        margin-top: 0.4em !important;
    }
}
 
/* æ•´ä½“å›¾æ ‡ */
i.icon {
    color: #000;
    width: 1.2em !important;
}
 
/* èƒŒæ™¯å›¾ç‰‡ */
body {
    content: " " !important;
    background: fixed !important;
    z-index: -1 !important;
    top: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    left: 0 !important;
    background-position: top !important;
    background-repeat: no-repeat !important;
    background-size: cover !important;
    background-image: url(https://image.6669998.xyz/ShEAaa.jpeg) !important;
    font-family: Arial,Helvetica,sans-serif !important;
}
 
/* å¯¼èˆªæ  */
.ui.large.menu {
    border: 0 !important;
    border-radius: 0px !important;
    background-color: rgba(255, 255, 255, 55%) !important;
}
 
/* é¦–é¡µæŒ‰é’® */
.ui.menu .active.item {
    background-color: transparent !important;
}
 
/* å¯¼èˆªæ ä¸‹æ‹‰æ¡† */
.ui.dropdown .menu {
    border: 0 !important;
    border-radius: 0 !important;
    background-color: rgba(255, 255, 255, 80%) !important;
}
 
/* ç™»é™†æŒ‰é’® */
.nezha-primary-btn {
    background-color: transparent !important;
    color: #000 !important;
}
 
/* å¤§å¡ç‰‡ */
#app .ui.fluid.accordion {
    background-color: #fbfbfb26 !important;
    border-radius: 0.4rem !important;
}
 
/* å°å¡ç‰‡ */
.ui.four.cards>.card {
    border-radius: 0.6rem !important;
    background-color: #fafafaa3 !important;
}

/* å¡ç‰‡å†…é—´è·ï¼Œå¦‚éœ€è°ƒæ•´å°å¡ç‰‡é«˜åº¦ï¼Œå¯ä»¥ä¿®æ”¹ä¸‹é¢çš„2.6remçš„æ•°å­— */
.status.cards .wide.column {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    height: 2.6rem !important;
}

.status.cards .three.wide.column {
    padding-right: 0rem !important;
}

.status.cards .wide.column:nth-child(1) {
    margin-top: 2rem !important;
}

.status.cards .wide.column:nth-child(2) {
    margin-top: 2rem !important;
}

.status.cards .description {
    padding-bottom: 0 !important;
}
 
/* å°é¸¡å */
.status.cards .flag {
    margin-right: 0.5rem !important;
}
 
/* å¼¹å‡ºå¡ç‰‡å›¾æ ‡ */
.status.cards .header > .info.icon {
    margin-right: 0 !important;
}

.nezha-secondary-font {
    color: #21ba45 !important;
}
 
/* è¿›åº¦æ¡åœ†è§’å’Œé¢œè‰² */
.ui.progress {
    border-radius: 50rem !important;
}

/* çŠ¶æ€è¿›åº¦æ¡ */
.ui.progress .bar {
    min-width: 1.8em !important;
    border-radius: 15px !important;
    line-height: 1.65em !important;
}

/* æ­£å¸¸çŠ¶æ€è¿›åº¦æ¡é¢œè‰² */
.ui.progress.fine .bar {
    background-color: #21ba45 !important;
}

/* æœ‰ç‚¹ç´¯çŠ¶æ€è¿›åº¦æ¡é¢œè‰² */
.ui.progress.warning .bar {
    background-color: #ff9800 !important;
}

/* é«˜è´Ÿè½½çŠ¶æ€è¿›åº¦æ¡é¢œè‰² */
.ui.progress.error .bar {
    background-color: #e41e10 !important;
}

/* ç¦»çº¿çŠ¶æ€è¿›åº¦æ¡é¢œè‰² */
.ui.progress.offline .bar {
    background-color: #000 !important;
}
 
/* ä¸Šä¼ ä¸‹è½½ */
.status.cards .outline.icon {
    margin-right: 1px !important;
}

i.arrow.alternate.circle.down.outline.icon {
    color: #21ba45 !important;
}

i.arrow.alternate.circle.up.outline.icon {
    color: red !important;
}
 
/* å¼¹å‡ºå¡ç‰‡å°ç®­å¤´ */
.ui.right.center.popup {
    margin: -3px 0 0 0.914286em !important;
    -webkit-transform-origin: left 50% !important;
    transform-origin: left 50% !important;
}

.ui.bottom.left.popup {
    margin-left: 1px !important;
    margin-top: 3px !important;
}

.ui.top.left.popup {
    margin-left: 0 !important;
    margin-bottom: 10px !important;
}

.ui.top.right.popup {
    margin-right: 0 !important;
    margin-bottom: 8px !important;
}

.ui.left.center.popup {
    margin: -3px .91428571em 0 0 !important;
    -webkit-transform-origin: right 50% !important;
    transform-origin: right 50% !important;
}

.ui.right.center.popup:before,
.ui.left.center.popup:before {
    border: 0px solid #fafafaeb !important;
    background: #fafafaeb !important;
}

.ui.top.popup:before {
    border-color: #fafafaeb transparent transparent !important;
}

.ui.popup:before {
    border-color: #fafafaeb transparent transparent !important;
}

.ui.bottom.left.popup:before {
    border-radius: 0 !important;
    border: 1px solid transparent !important;
    border-color: #fafafaeb transparent transparent !important;
    background: #fafafaeb !important;
    -webkit-box-shadow: 0px 0px 0 0 
#fafafaeb !important;
    box-shadow: 0px 0px 0 0 #fafafaeb !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
}

.ui.bottom.right.popup:before {
    border-radius: 0 !important;
    border: 1px solid transparent !important;
    border-color: #fafafaeb transparent transparent !important;
    background: #fafafaeb !important
-webkit-box-shadow: 0px 0px 0 0 #fafafaeb !important;
    box-shadow: 0px 0px 0 0 #fafafaeb !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
}

.ui.top.left.popup:before {
    border-radius: 0 !important;
    border: 1px solid transparent !important;
    border-color: #fafafaeb transparent transparent !important;
    background: #fafafaeb !important;
    -webkit-box-shadow: 0px 0px 0 0 #fafafaeb !important;
    box-shadow: 0px 0px 0 0 #fafafaeb !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
}

.ui.top.right.popup:before {
    border-radius: 0 !important;
    border: 1px solid transparent !important;
    border-color: #fafafaeb transparent transparent !important;
    background: #fafafaeb !important;
    -webkit-box-shadow: 0px 0px 0 0 #fafafaeb !important;
    box-shadow: 0px 0px 0 0 #fafafaeb !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
}

.ui.left.center.popup:before {
    border-radius: 0 !important;
    border: 1px solid transparent !important;
    border-color: #fafafaeb transparent transparent !important;
    background: #fafafaeb !important;
    -webkit-box-shadow: 0px 0px 0 0 #fafafaeb !important;
    box-shadow: 0px 0px 0 0 #fafafaeb !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
}
 
/* å¼¹å‡ºå¡ç‰‡ */
.status.cards .ui.content.popup {
    min-width: 20rem !important;
    line-height: 2rem !important;
    border-radius: 5px !important;
    border: 1px solid transparent !important;
    background-color: #fafafaeb !important;
    font-family: Arial,Helvetica,sans-serif !important;
}

.ui.content {
    margin: 0 !important;
    padding: 1em !important;
}
 
/* æœåŠ¡é¡µ */
.ui.table {
    background: RGB(225,225,225,0.6) !important;
}

.ui.table thead th {
    background: transparent !important;
}
 
/* æœåŠ¡é¡µè¿›åº¦æ¡ */
.service-status .good {
    background-color: #21ba45 !important;
}

.service-status .danger {
    background-color: red !important;
}

.service-status .warning {
    background-color: orange !important;
}

/* æç¤ºæ¶ˆæ¯ */
.floating.message.success {
    backdrop-filter: blur(15px) brightness(110%);
    background-color: rgba(255, 255, 255, 0.556);
    border: 3px solid rgba(225.225.255.0.5);
    border-radius: 1rem !important;
    color: black;
    box-shadow: 0 0 15px rgba(33, 186, 69, 0.66);
}

.floating.message.success .header {
    color: black;
}

.floating.message.warning {
    backdrop-filter: blur(15px) brightness(110%);
    background-color: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(225.225.255.0.5);
    border-radius: 1rem !important;
    color: black;
    box-shadow: 0 0 15px rgba(33, 186, 69, 0.66);
}

.floating.message.warning .header {
    color: black;
}
 
/* ç‰ˆæƒ */
.ui.inverted.segment, 
.ui.primary.inverted.segment {
    color: #000 !important;
    font-weight: bold !important;
    background-color: #fafafaa3 !important;
}
</style>
 
<!--Logoå’Œç‰ˆæƒ-->
<script>
window.onload = function() {
var avatar=document.querySelector(".item img")
var footer=document.querySelector("div.is-size-7")
footer.innerHTML="samğŸŒ¸æ¢é’ˆ"
footer.style.visibility="visible"
avatar.src="https://img14.360buyimg.com/ddimg/jfs/t1/162473/22/23012/3692/6184b06aEa95a0194/8c51cebbd04b95b2.png"
avatar.style.visibility="visible"
}
</script>

<!--æ›¿æ¢é»˜è®¤Favicon-->
<script>
var faviconurl="https://tu.i3.pw/imgs/2024/02/5732d756934585ff.jpg";
var link = document.querySelector("link[rel*='icon']") || document.createElement('link');
link.type = 'image/png';
link.rel = 'shortcut icon';
link.href = faviconurl;
document.getElementsByTagName('head')[0].appendChild(link);
</script>
```

å‚è€ƒï¼š
[nezha](https://nezha.wiki/)
[80å blong](https://idcfq.com/660.html)
[nezhaä¸»é¢˜](https://blog.mochen.one/archives/86)
