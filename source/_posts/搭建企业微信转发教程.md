---
title: 快速搭建企业微信转发教程
tags:
  - docker
  - 观影一条龙
categories: Docker
cover: 'https://image.6669998.xyz/y26yWz.png'
description: 快速搭建企业微信转发教程
abbrlink: 4c4d33b3
date: 2024-04-24 10:19:19
top:
password:
---
-  通过配置Nginx和docker一键部署
- 青龙面板的企业微信通知也是可以的(使用方案二)

# 服务器安装Docker(方案一)

- [Dcoker 安装教程](https://xx.6669998.xyz/post/4eb3381c.html)

### 服务器放行端口

- 在Linux系统上，不同的发行版会使用不同的防火墙软件，包括iptables、firewalld和ufw
- 以下是针对不同系统的Docker安装命令和放行3000端口的防火墙设置示例：

### iptables

````markdown
sudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT
sudo iptables-save
````

### firewalld

```markdown
sudo firewall-cmd --zone=public --add-port=3000/tcp --permanent
sudo firewall-cmd --reload
```

### ufw (Uncomplicated Firewall)

```markdown
sudo ufw allow 3000/tcp
```

## Docker快速搭建

- [项目地址](https://github.com/DDS-Derek/wxchat-Docker)
- 示例为：3000端口

- docker 

```markdown
docker run -d \
    --name wxchat \
    --restart=always \
    -p 3000:80 \
    ddsderek/wxchat:latest
```

- docker compose

```markdown
version: '3.3'
services:
    wxchat:
        container_name: wxchat
        restart: always
        ports:

   - '3000:80'
     ddsderek/wxchat:latest'
```

## 配置参数和填写可信IP

- 然后ip填进可信ip 里面就行了 回调api啥的都去保存成功了 基本就完事了
- 记得填写 http://ip:3000 哦 http开头！！！切记（直接填写ip行不行我也不知道 反正你别加https://就行）

[参考教程](https://blog.ptlsp.com/weixinzhuanfadaili/)

# 服务器安装Docker(方案二)

## 准备工作

你不需要准备太多东西，只需要一个企业微信账号。个人也能免费注册，去官网 (`https://work.weixin.qq.com/wework_admin/register_wx`) 填些基本信息就好。
![1765266195417.png](https://image.6669998.xyz/oNzEKS.png)

## 第一步：**创建你的企业微信应用**

首先，登录企业微信后台，找到 **「应用管理」->「自建」->「创建应用」**。

这里需要你上传一个应用Logo（随便找张图就行），再给应用起个名字，比如我就叫它“测试”。
![1765266260002.png](https://image.6669998.xyz/Hk4iup.png)

应用创建成功后，点进去。有三个关键信息将作为后续所有操作的“身份凭证”，**请务必找个地方把它们记下来**：

1.  `AgentId` (应用ID)
2.  `Secret` (应用密钥，需要用企业微信App扫码查看，切勿泄露)
3.  `企业ID` (在后台 **「我的企业」** 页面，拉到最下方就能看到)

![1765266330485.png](https://image.6669998.xyz/5uKXTA.png)

**提醒一下**：别忘了在应用的“可见范围”里，把你希望接收消息的同事（或者就你自己）加进去，否则机器人会不知道该把消息发给谁。

### 第二步：**搞定最关键的“可信IP”**

这是整个流程中最容易让人放弃的地方。

正常情况下，企业微信要求你提供一个公网服务器地址（URL）。它会向这个地址发送一个验证请求，你的服务器需要给出正确的回应，才算通过。验证通过后，才能继续添加“可信IP”。

但我们大多数人哪有现成的公网服务器来做这个事呢？别慌，我们可以“借”一个。

![1765266393422.png](https://image.6669998.xyz/4rLCxi.png)
    
 进去之后，`Token` 和 `EncodingAESKey` 这两项，直接点右侧的“随机获取”。**然后，立刻把这两个值复制下来备用。**

![1765266454339.png](https://image.6669998.xyz/qCdkqb.png)
        
**接下来是重点**：打开下面这个我搭建的中转服务网站，它专门用来完成这次验证“握手”。
**地址：`https://push.wangwangit.com`**

把上一步你复制的 `Token` 和 `EncodingAESKey` 粘贴到网站对应的输入框里，它会立刻为你生成一个临时的回调URL。

![1765266567769.png](https://image.6669998.xyz/rcFO7Q.png)

**将这个刚刚生成的URL，完整地复制粘贴回企业微信的“URL”配置框中**，然后点“保存”。Duang！你会惊喜地发现，验证竟然直接通过了！

这一步的原理，就是我们借用了这个中转服务作为“跳板”，它帮我们接收并正确地响应了企业微信的验证请求。验证完成后，这个跳板的使命就结束了。

URL验证通过后，企业微信的“企业可信IP”功能也就随之解锁了。现在，你就可以把你**真正用来发消息的服务器IP**填进去了。

-   • 如果你有服务器，就填服务器的公网IP。
-   • 最直接的，你甚至可以把你家当前的公网IP填进去（缺点是IP地址改变后，需要回来重新修改）。

![1765266603060.png](https://image.6669998.xyz/4yXIPm.png)

添加完这个IP后，今后只有来自该IP的请求才能调用API发消息，非常安全。

### **第三步：生成你的专属推送URL**

到这里，企业微信后台的配置基本完成了。理论上，你已经可以对照着官方API文档，自己写代码来调用接口、推送消息了。

但为了“懒”得更彻底一点，我们可以继续使用那个中转服务，它能把复杂的API调用过程，封装成一个极其简单的URL。你只需要请求这个URL，就能轻松发消息。

> **动手能力强的同学，可以去GitHub上自己部署这个服务，实现完全私有化：`https://github.com/wangwangit/qywx-push`**

这里我继续用公共服务来演示：

1.  再次回到中转服务网站：`https://push.wangwangit.com`
2.  这次，我们把**第一步**记录的 `企业ID`、`Secret`、`AgentId` 填到下方的“生成推送URL”配置区。
3.  点击“获取成员列表”，选中你希望接收消息的用户（注意：用户需要先在企业微信中关注你的企业和这个自建应用）。
4.  点击“完成配置”。

![1765266652480.png](https://image.6669998.xyz/QiPyyV.png)

![1765266661968.png](https://image.6669998.xyz/LsiTxq.png)


网站会立刻为你生成一个专属的调用地址。**这个地址非常重要，请务必保存好！** 你可以点击右上角的“API文档”查看详细的调用方法。

![1765266673786.png](https://image.6669998.xyz/m126eX.png)

今后，如果你想让AI帮你写一段带通知功能的代码，你只需要把这个URL和对应的API文档一起告诉它，就能快速搞定。

### **最后：享受你的成果！**

现在，大功告成！

无论你想在Shell脚本、Python程序，还是任何支持HTTP请求的地方实现通知功能，只需要调用一下上面生成的那个专属URL，消息就能瞬间推送到你的企业微信里。

从今以后，再也不用被塞满报告的邮箱困扰了！

发现群机器人配置更方便,可以参考 [消息推送配置说明 - 文档 - 企业微信开发者中心](https://developer.work.weixin.qq.com/document/path/91770) xhj003 ,另外大家注意一下,“可信IP”配置步骤,有一个授权API的勾选,请根据自己情况进行取消或者调整! xhj003 ,所有授权的"事件类型"消息都会上传到配置的这个地址的! 推荐大家自建!

- **[参考教程](https://linux.do/t/topic/770848)**